{% extends 'base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>–î–≤–∏–∂–µ–Ω–∏–µ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤</h1>
    <a href="{% url 'transaction_create' %}" class="btn btn-primary">+ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å</a>
</div>

<!-- –ü—Ä–æ—Å—Ç—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã -->
<div class="card mb-4">
    <div class="card-header">
        <h5>–§–∏–ª—å—Ç—Ä—ã</h5>
    </div>
    <div class="card-body">
        <form method="get" class="row g-3">
            <div class="col-md-2">
                <label class="form-label">–î–∞—Ç–∞ –æ—Ç</label>
                <input type="date" name="date_after" class="form-control" value="{{ current_filters.date_after }}">
            </div>
            <div class="col-md-2">
                <label class="form-label">–î–∞—Ç–∞ –¥–æ</label>
                <input type="date" name="date_before" class="form-control" value="{{ current_filters.date_before }}">
            </div>
            <div class="col-md-2">
                <label class="form-label">–°—Ç–∞—Ç—É—Å</label>
                <select name="status" class="form-select">
                    <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                    <option value="–ë–∏–∑–Ω–µ—Å" {% if current_filters.status == "–ë–∏–∑–Ω–µ—Å" %}selected{% endif %}>–ë–∏–∑–Ω–µ—Å</option>
                    <option value="–õ–∏—á–Ω–æ–µ" {% if current_filters.status == "–õ–∏—á–Ω–æ–µ" %}selected{% endif %}>–õ–∏—á–Ω–æ–µ</option>
                    <option value="–ù–∞–ª–æ–≥" {% if current_filters.status == "–ù–∞–ª–æ–≥" %}selected{% endif %}>–ù–∞–ª–æ–≥</option>
                </select>
            </div>
            <div class="col-md-2">
                <label class="form-label">–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏</label>
                <select name="operation_type" class="form-select">
                    <option value="">–í—Å–µ —Ç–∏–ø—ã</option>
                    <option value="–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ" {% if current_filters.operation_type == "–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ" %}selected{% endif %}>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</option>
                    <option value="–°–ø–∏—Å–∞–Ω–∏–µ" {% if current_filters.operation_type == "–°–ø–∏—Å–∞–Ω–∏–µ" %}selected{% endif %}>–°–ø–∏—Å–∞–Ω–∏–µ</option>
                </select>
            </div>
            <div class="col-md-12">
                <button type="submit" class="btn btn-primary">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
                <a href="{% url 'transaction_list' %}" class="btn btn-secondary">–°–±—Ä–æ—Å–∏—Ç—å</a>
            </div>
        </form>
    </div>
</div>

<!-- –¢–∞–±–ª–∏—Ü–∞ —Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ -->
<div class="card">
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>–î–∞—Ç–∞</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–¢–∏–ø</th>
                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                        <th>–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                        <th>–°—É–º–º–∞</th>
                        <th>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for transaction in transactions %}
                    <tr>
                        <td>{{ transaction.date|date:"d.m.Y" }}</td>
                        <td>{{ transaction.status }}</td>
                        <td>{{ transaction.operation_type }}</td>
                        <td>{{ transaction.category }}</td>
                        <td>{{ transaction.subcategory }}</td>
                        <td>{{ transaction.amount }} ‚ÇΩ</td>
                        <td>{{ transaction.comment|default:"-" }}</td>
                        <td>
                            <a href="{% url 'transaction_update' transaction.pk %}" class="btn btn-sm btn-warning">‚úèÔ∏è</a>
                            <a href="{% url 'transaction_delete' transaction.pk %}" class="btn btn-sm btn-danger">üóëÔ∏è</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="8" class="text-center">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}